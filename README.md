# 🎉ダークモード化MOD

* aviutl2のダークモード化されていない部分を補完することを目的としたMODです。
* 現時点では「入力プラグイン」形式になっています。
* `jd`は`just dark`または`二黒土星(jikoku dosei)`の略です。

## 🚧注意事項

* メインスレッドだけをダークモード化します。
	* 「ファイルのプロパティ」ダイアログなどは対象外です。
* `データフォルダ`とは`C:\ProgramData\aviutl2`または`aviutl2.exeがあるフォルダ\data`のことです。
* `プラグインフォルダ`とは`データフォルダ\Plugin`のことです。

## 🚀インストール

* `プラグインフォルダ`フォルダに以下のファイルを入れてください。
	* `al2_jd.aui2`
	* `DarkenWindow.aul`
	* `al2` (フォルダ)
	* (上記ファイルはzipファイル内の`Plugin`フォルダに入っています)

## 🔥アンインストール

* `プラグインフォルダ`フォルダから以下のファイルを削除してください。
	* `al2_jd.aui2`
	* `DarkenWindow.aul`

## 💡使い方

### 🏷️`ダークモード化の設定`ダイアログを表示する

1. aviutl2ウィンドウのメニューで`設定`を選択します。
1. `入力プラグインの設定`を選択します。
1. `入力プラグインの設定`ダイアログが表示されます。
1. `ダークモード化`を**右クリック**します。
1. `プラグインの設定`を選択します。
1. `ダークモード化の設定`ダイアログが表示されます。
1. `入力プラグインの設定`ダイアログだけを閉じます。

### 🏷️設定を初期化する

1. aviutl2を起動していない状態で`al2\config\al2_jd.json`を削除します。

### 🏷️`拡張 x264 出力(GUI) Ex`の設定ダイアログにスタイルを適用する

1. aviutl2を「管理者として実行」します。
2. `拡張 x264 出力(GUI) Ex`の設定ダイアログを表示します。
3. ダークモード化されているか確認します。
4. 管理者権限のaviutl2を一旦閉じます。
5. aviutl2を通常実行します。
6. `拡張 x264 出力(GUI) Ex`の設定ダイアログを表示します。
7. ダークモード化されているか確認します。

> [!IMPORTANT]
> * 1~4は初回またはスタイルファイルを変更したときにだけ実行してください。
> * またはaviutl2を管理者権限を必要としないフォルダにインストールしてください。

## 🔧設定

* `ダークモード化の設定`ダイアログで設定します。
---
* `フォントプレビューの設定`
	* `ウィンドウのサイズ`✏️フォント一覧リストボックスの大きさを指定します。
	* `アイテムの高さ`✏️リストボックスの項目の高さを指定します。
	* `フォントの高さ`✏️フォントの高さ(大きさ)を指定します。
	* `サンプルテキストの書式`✏️サンプルテキストの書式を指定します。
		* `%font%`はフォント名に置換されます。
	* `メニューで使用`✏️メニュー項目がフォント名の場合はそのフォントで描画します。
		* ただし、上記のサイズなどの設定は適用されません。
	* `リストボックスで使用`✏️リストボックス項目がフォント名の場合はそのフォントで描画します。
	* `リストビューで使用`✏️リストビュー項目がフォント名の場合はそのフォントで描画します。
		* ただし、上記のサイズなどの設定は適用されません。
* `ダークモード化の設定`
	* `スタイルファイルのパス`✏️現在開いているスタイルファイルのパスが表示されます。
		* `...`ボタンで読み込むスタイルファイルを変更できます。
		* 現在開いているスタイルファイルが編集されると自動的に再読み込みされます。
		* **※ただし、新しい配色が反映されるのは一部(メニュー・スクロールバー・ダイアログなど)だけです。**
	* `スクロールバーの太さ(%)`✏️スクロールバーの太さを%単位で指定します。
	* `矢印をボタンとして描画`✏️チェックを入れるとスクロールバーの矢印をボタンとして描画します。
	* `つまみのグリッパーを描画`✏️チェックを入れるとスクロールバーのつまみにグリッパーを描画します。
	* `コモンダイアログを除外`✏️チェックを入れるとコモンダイアログをダークモード化しないようにします。
		* **※一部はaviutl2を再起動しないと正常に描画されない場合があるので注意してください。**
	* `タイトルバーをスリムにする`✏️チェックを入れるとタイトルバーとメニューバーが一体化します。
* `その他の設定`
	* `通常のマウスアクティブ化処理`✏️チェックを入れると非アクティブなaviutl2をクリックしたとき、マウス処理が破棄されなくなります。
* `ダイアログ名のパターン`**✏️※ダイアログ右側に配置されています。**
	* 各ダイアログ名を正規表現のパターンで指定します。
	* aviutl2を翻訳して使用している場合はそれに合わせて変更してください。

## 📝スタイルファイル

* このプラグインは以下の流れでスタイルファイルを読み込みます。
	1. まず、`aviutl2.exeがあるフォルダ\data\style.conf`を読み込みます。
	1. 読み込めなかった場合は、代わりに`C:\ProgramData\aviutl2\style.conf`を読み込みます。
	1. 読み込めなかった場合は、代わりに`aviutl2.exeがあるフォルダ\style.conf`を読み込みます。

## 📝独自スタイルファイル

* `プラグインフォルダ/al2/assets/custom_color.conf`を`プラグインフォルダ/al2/config/`フォルダにコピーします。
* `プラグインフォルダ/al2/config/custom_color.conf`をテキストエディタで編集します。

> [!IMPORTANT]
> * メニューなど一部の配色だけ変更できます。aviutl2本体の配色は変更できません。

### 書式

* `UTF-8`の`iniファイル`のようなファイル形式になっています。
* `セクション`✏️主にコントロールまたはそのパーツの名称になっています。
* `キー`✏️主にコントロールのステートの名称になっています。
	* `サフィックス`
		* `Fill`✏️背景の色です。
		* `Edge`✏️縁の色です。
		* `Text`✏️テキストの色です。
* `色の値`
	* `rrggbb`形式の16進数で指定します。

### 例

* エディットボックスの選択色を赤に変更します。

```ini
[EditBox]
SelectFill=ff0000
```

## 🔖更新履歴

* 🔖r16 #2025年09月08日
	* 🩹フォントメニューがフォントを使用して描画されない問題に対応
	* 🔥最後に入力した設定値を使用する機能を削除
	* ⚡️ダイアログ名を指定できるように変更
* 🔖r15 #2025年08月31日
	* 💥カスタムカラーを指定できるように変更
	* 🩹シーンリストに動画をドロップしたときも最後の設定値を復元してしまう問題に対応 #7
	* 🩹beta9でプリセットが選択できなくなった問題に対応 #8
	* ⚡️最後に入力した設定値を使用するかどうか選択できるように変更
	* 🔥不要な設定を削除
* 🔖r14 #2025年08月22日
	* 💥メニューバーとタイトルバーを一体化する機能を追加
* 🔖r13 #2025年08月17日
	* ✨スタイルファイルを再読み込みする機能を追加
* 🔖r12 #2025年08月16日
	* 💥「MP4出力」`拡張 x264 出力(GUI) Ex`の設定ダイアログに対応
	* 🎨ラジオボタンの見た目を変更
* 🔖r11 #2025年08月11日
	* 💥コモンダイアログをダークモード化しない機能を追加
	* 🎨スクロールバーの背景を変更
	* 🎨ファイル選択ダイアログのツリービューとリストビューにボーダーを追加
* 🔖r10 #2025年08月11日
	* ⚡️縦横反転のチェックボックスをクリックしたときにも映像サイズの縦横を入れ替えるように変更
* 🔖r9 #2025年08月11日
	* ✨「レイヤー名を変更」ダイアログでプリセットから設定を選択できる機能を追加
* 🔖r8 #2025年08月10日
	* ✨「シーンを作成」「シーンの設定」ダイアログでプリセットから設定を選択できる機能を追加
* 🔖r7 #2025年08月09日
	* ⚡️ファイル選択ダイアログ上部への対応を強化
	* ⚡️スクロールバーのつまみにグリッパーを描画する機能を追加
* 🔖r6 #2025年08月04日
	* ✨「プロジェクトの作成」ダイアログでプリセットから設定を選択できる機能を追加
	* ✨ついでに前回の設定値を引き継ぐ機能を追加
* 🔖r5 🗓️2025.08.03
	* ✨フォントを使用してリストビューを描画する機能を追加
* 🔖r4 🗓️2025.08.02
	* ✨フォントを使用してメニューを描画する機能を追加
* 🔖r3 🗓️2025.07.31
	* ✨フォントを使用してリストボックスを描画する機能を追加
* 🔖r2 🗓️2025.07.29
	* 💥ダイアログをダークモード化
* 🔖r1 🗓️2025.07.24
	* 🎉初版

## ⚗️動作確認

* AviUtl ExEdit2 beta10 https://spring-fragrance.mints.ne.jp/aviutl/

## 💳クレジット

* AviUtl ExEdit2 Plugin SDK https://spring-fragrance.mints.ne.jp/aviutl/
* Microsoft Research Detours Package https://github.com/microsoft/Detours
* JSON for Modern C++ https://github.com/nlohmann/json

## 👽️作成者情報
 
* 作成者 - 蛇色 (へびいろ)
* GitHub - https://github.com/hebiiro
* X - https://x.com/io_hebiiro

## 🚨免責事項

この作成物および同梱物を使用したことによって生じたすべての障害・損害・不具合等に関しては、私と私の関係者および私の所属するいかなる団体・組織とも、一切の責任を負いません。各自の責任においてご使用ください。
